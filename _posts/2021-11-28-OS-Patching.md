---
layout: post
read_time: true
show_date: true
title:  Operating System Patching
date:   2021-11-28 10:00:00 +1000
description: How to go about patching operating systems.
img: posts/2021-11-28-OS-Patching/hero.jpg
tags: [security,non-technical]
author: Peter Dodemont
---
In this article I'll take you through what I have learned over the years of implementing operating system patching. I will cover things like my preferred process and the tools I have used as well as how to manage it on different device types.
This will be mostly focused on Windows devices as that is what I have supported for most of my career, however the principles can be applied to other operating systems as well (you'll need different tools to ones I mention though).

## Automation
Let me start off with what is probably my number one advice, automate the patching. Systems should be patched every cycle, unless specific action is taken not to patch them. There are so many new vulnerabilities being patched each cycle that missing the patching because it is a manual process poses significant risk. Not only does it increase the risk, it also means your next patching cycle will become longer and riskier as there are more patches to be applied.
By automating the process, you no longer need to remember or make time for it, you can set and forget. I know that now some of you will be thinking but what about testing the patches to make sure nothing breaks. I'll cover that off in my next point which talks about the actual process I use.

## The Process
When automating the installation of patches, you need to make sure that the process you put in place is robust. It needs to not just handle the installation but also the testing of patches. To that end I use a 3-step process to install patches. I apply this process to both end user devices as well as severs.
The 1st step is deploying the patches to a very small group. This first step is to ensure that the patches don't have significant issues (e.g. causing a BSOD or similar).
On the end user site this usually includes a few members of the IT team, and if possible, avoiding choosing everyone in a team (e.g. only some of the service desk and/or engineering teams). Since the idea of this group is just to make sure there are no major issues this group is only a handful of people.
On the server side this group includes servers that can be taken offline for a day or 2 without any business disruption. Usually this will be test servers or if you don't have any test servers, it can be servers for services that have load balancing or failover in place.
This step gets initiated on the day of the release of the patches. Patches will get applied ASAP. On the end user devices this means the user will get a restart prompt and on servers it usually means running it outside of business hours, although occasionally I have had a server that could be rebooted during business hours as well.
The 2nd step is deploying the patches to a representative sample of users/servers. The idea of this 2nd group is to make sure that normal day to day operation will not be disrupted when the patches are installed. I also never implement a testing schedule for this group. You might think this is weird, but since the goal of this group is to cover of day to day, the testing will take care of itself by virtue of people and servers doing their normal jobs.
On the end user side, I call this group the "Business Test Users". This group should include at least 1 person from each team or department of the business. This group can be tricky to get set up as it usually requires talking with each department and asking for someone to be put forward. Putting a deadline on it helps, as does saying you will randomly pick someone if they do not meet the deadline. The most effective item I have found to getting buy in though, is making sure to let them know that you don't expect these people to do anything special. They just need to reliable in logging calls with the service desk when they arise. This is also the way I "randomly" select people, based on who logs tickets in regularly with the service desk.
On the server side getting this group together is more complicated. There will be some easy choices of servers to add to this group, namely any servers that have fail over or redundancy. You can just add half of those servers to this group without causing any major issues. For the servers that do not have fail over or redundancy it really comes down to selecting the servers that will only completely take the business offline if there are issues. If you have systems that are integrated or interact with each other heavily only putting half of those in the group. I usually also include servers that will not cause immediate business impact like a monitoring system or reporting system. You will want to have about 50% of the servers in this group.
This step gets run straight after the end of the previous step, which is 2 or 3 days after the release of the patches. It lasts for 7 days. Patches are installed after business hours on both servers and include automatic rebooting of the servers. On End user devices patches get installed ASAP with a prompt for reboot. The prompt can be dismissed a set number of times before a reboot is forced.
Step 3 is rolling out the patches to the remaining users and servers. By now you should be confident that there will be no significant issues for end users, so the patches are rolled out to all devices. On the server side you should know that there are no issues on any services with fail over or redundancy, but there might still be some other services that could have issues. But this would again only be about 50% of the business as with the last step.
The step will start 7 days after step 2 and also run for 7 days. The deployment process is identical to step 2 for both end users and servers.
A crucial part of the process is the review the members of all he different groups once every 6 months to make sure that if any people left they are replaced with a new person or that you don't need to rebalance any of the server groups

I find the above process strikes a fair balance between all the risks. Patches are applied within 2 weeks to most devices, but you are also minimising the risk of causing business disruption by having the patches rolled out in separate stages.

## Tools
There are several tools that I have used over the years each has their own pros and cons. I won't go into a lot of details on each of the tools, but I will list what I like or dislike about them.
I'll start off with a stand-alone WSUS server. This is my least favourite setup as it requires quite a bit maintenance to keep going properly and you also don't really have precise control over timings.
I have also used SCCM in a number of my previous places and SCCM is a mighty powerful application with a lot of options. If you already have SCCM infrastructure in place this would be what I recommend. With features like Windows Updates maintenance windows, availability times and deadlines you can have a very high degree of control of how and when updates get installed. The only real issue I have with it, is that you need to apply these policies to devices. For servers this is not an issue, but for the end user devices this is harder as you to ensure the create collections that get the user's device. You also have separate control over quality and feature updates which provides you with some additional flexibility to delay feature updates and do more through testing.
If you do not have SCCM in place MEM/Intune is a great solution for deploying to end user devices. Like SCCM you have control over quality and features updates separately. But it also offers a number of additional options, like pushing certain updates out as a priority or preventing a subset of devices from installing feature updates. These can also all be achieved with SCCM, but when I last used SCCM these were not built-in so required more work (this might have changed by now). One of the great advantages of MEM is that all policies can be targeted at users, and it will apply to any device the user logs into. This is really helpful in for updates as you don't need to manage separate lists. But MEM does not support server operating systems. So, if you are using MEM for end user devices, you will need to use another solution for servers. There are numerous options out there (e.g. Azure Update Management, Qualys, Solarwinds). I have not implemented any of these myself yet, but our current MSP uses Qualys which seems to work well, and I will be trialing Azure Update Management in the near future (and I will update this aticle once I have). These solutions generally also provide support for Linux as well as Windows which is something SCCM does not.

I hope this article proves helpful to assist you in designing a operating system update policy. If you have any questions or comments please reach out.