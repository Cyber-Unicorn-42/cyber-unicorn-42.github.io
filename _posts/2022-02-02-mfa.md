---
layout: post
read_time: true
show_date: true
title:  Modern Multi-factor Authentication
date:   2022-02-05 10:00:00 +1000
description: How do you deploy MFA without creating a huge burden on your users.
img: posts/2022-02-02-mfa/hero.png
tags: [security,non-technical]
author: Peter Dodemont
---
Almost everyone these days knows what multi-factor authentication is, but what I don't think a lot of people know is that there are a lot of different ways you can implement MFS. There are great solutions out there where you only prompt users to input a one-time code or accept a notification on their phone in the most extreme cases. In normal day to day usage, you can use lots of other details related to the user's login as an additional factor.

## Traditional Multi-Factor Authentication
The reason most of us know about the "traditional" MFA options is that business have started implementing them on a significant scale for all their customers. The traditional code or prompt are great ways to provide MFA to customers who only need log into your service relatively infrequently. And while it's mostly still an optional feature you need to enable, more and more people are enabling it as they are being impacted by the increasing amount of data breaches, either directly or indirectly. A few years ago, adding a MFA prompt to a login process would not have been as widely accepted as it is today, as the added friction would have turned people away. These days the perception of that added friction is outweighed by the gain in security for a growing number of people.
If we look on the internal business side of things, MFA used to traditionally only be used on VPN/remote access services. If you were around back then, you probably recognize the RSA token.
![RSA Token](/assets/img/posts/2022-02-02-mfa/rsa.jfif "RSA Token")
These tokens were the precursor to what we have as authenticator apps on our phones today. They work in much the same way that they generate a new 6-digit codes every 30 seconds. And you need to enter the code displayed in a field to get access.
These days you hardly ever see any of these tokens anymore as they are quite cumbersome since they are a additional physical device you need to carry around. It is much more convenient to have an application on your phone that does the same thing. Most people carry their phone around with them everywhere they go anyway, so there is no additional burden there.

## Modern Multi-Factor Authentication
As with most, if not all, things in the IT world, MFA has evolved over time. These days MFA doesn't necessarily require the use of a token at every login anymore. Most identity provider, as in a service providing you with infrastructure to handle the login process, have options to provide MFA by looking at some of the details of the actual login. The details they look can vary, but they will usually include the location, the time of day, the source IP address, details of the device being used and more. These additional details can then be used as a second or third or ... factor in the login process. For example, you could specify to only allow connection from a certain location or from a particular time of day. And only if the login attempt happens outside of these rules, would you prompt for the traditional factor of the code. While this might work for small companies with a small number of employees, it quickly becomes unusable, this is where risk-based authentication comes in.

## Risk-Based Authentication
With risk-based authentication you use all the details that have been collected to determine a risk rating for the sign in. This mainly revolves around looking at details of previous logins by the same person or other people in the same company. This does mean that identity providers will store these additional details to form a profile of what a "normal" login looks like for that person. Once they have that profile, they can compare the current attempt to the details and determine if enough factors are "unusual" to flag the login with a certain risk level.
Let me give you an example, say on a normal day I login around 7am from my home in Sydney, I then work logging in and out of different cloud services either interactively or via SSO, finally I log off around 5pm. Then one day there is a login attempt at 10pm from my home in Sydney. This is unusual as normally I login at that time, the identity provider can then go through my login history and see that this is unusual, but not totally uncommon as I have done this on other occasions as well. So, the login will likely not be flagged as risky. A few days later there is another login attempt at 6pm this time and it's from London. Again, the identity provider can check my profile and can determine that this could in fact be me, as it would be around 7am in London at the time. Then the next day we have a login at 2am from Las Vegas. This time the login is flagged as risky. 2am in Sydney is around 7am in Vegas, so that would be possible, but it is unlikely I would have been able to make it too Vegas from London in between the time of my last log online activity it registered.
This is just a simple example using only time and location, but identity providers collect a lot more details about each login and as such can make much more accurate predictions on if a login might be risky or not. The quality of the details gathered as well as the scale of the identity provider are going to have an impact, as with more data point you can make better predictions. And by having lots of profile for lots of users you can also create better models of what shared indicators e.g., how it will take to travel from one place to another.
What to do exactly at the different risk levels can usually be customized, the options will normally be: do nothing and let it through, prompt for a code or notification acceptance, block the attempt or force a password reset where the authentication happens through a prompt of a code or acceptance of a notification. Usually, I will configure systems to allow low risk, prompt for MFA on medium risk and force a password reset on high risk.
risk-based authentication is mostly used within corporate environments as have stable activity from your users, they mostly come in and work in the same areas at the same time each day. So, it is much easier to create those profiles and not have huge amounts of false positives.
For the customers of a business this is a lot harder as the behavior is most likely a lot less predictable. If you take a shopping website as an example, users can log into it a bunch of days in a row when they are looking for a particular item, and then nothing for months as they don't need to buy anything anymore. There are off course exceptions to this, and the one industry that does use risk-based authentication that comes to mind immediately is banking. They don't only apply it to your logins, but they also apply it to your purchases as a way of detecting fraudulent transactions. I don't have details on what they look at exactly as that would be closely guarded, but you can be sure they collect significant amounts of information on each of your transactions to build a as accurate as possible profile of you.
Which brings us to what I believe is probably the biggest benefit to using risk-based authentication, you can eliminate the need to prompt the users for MFA, and instead rely on all these additional details as additional factors. And having a much better MFA user experience. Since users will only occasionally be prompted for the token, they are going to be a lot less likely to try and find a work around for it.

I hope this article provides some insight into what to consider when you want to implement MFA. I think user experience is something the is generally forgotten about and the focus is solely on the additional security provided by a solution in isolation. Most users want to get whatever they need done, done as efficiently as possible. And if the user experience is terrible, they will find a work-around for it, meaning you will likely lose a lot of the benefit from the solution you implemented.
Personally, I always trial any new solution on myself for a while and if I find I can't even live with it, it is not going to be implemented in that way no matter the benefit. I then go back to the drawing board and rework the solution before testing it on myself again until I can comfortably deal with it myself. I then try to put myself in a user's shoes and see if me from 15 years ago would also be ok with this solution.

As always, if you have any questions or comments, please reach out.